<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>WELDING OPERATOR PERFORMANCE QUALIFICATION TEST RECORD (WOPQ)</title>
  <style>
    body { 
      font-family: Arial, sans-serif; 
      margin: 0; 
      padding: 15px; 
      background-color: #f5f5f5; 
      font-size: 10px;
      line-height: 1.2;
      color: #333;
    }
    .container { 
      max-width: 1000px; 
      margin: 0 auto; 
      background: white; 
      padding: 20px; 
      box-shadow: 0 2px 10px rgba(0,0,0,0.1); 
      border-radius: 4px;
    }
    
    /* Document Title */
    .document-title {
      text-align: center;
      font-size: 16px;
      font-weight: bold;
      color: #333;
      text-transform: uppercase;
      letter-spacing: 1px;
      margin: 0 0 20px 0;
      border-bottom: 2px solid #333;
      padding-bottom: 10px;
    }
    
    /* Header Section */
    .header-section {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: 20px;
      padding-bottom: 15px;
      border-bottom: 2px solid #333;
    }
    
    .logo-section {
      flex: 1;
    }
    
    .ateco-logo {
      width: 100px;
      height: auto;
      margin-bottom: 8px;
    }
    
    .company-info {
      font-size: 9px;
      color: #666;
      line-height: 1.2;
    }
    
    .profile-section {
      flex: 1;
      text-align: right;
      display: flex;
      gap: 10px;
      align-items: flex-start;
      justify-content: flex-end;
    }
    
    .profile-container {
      display: inline-block;
      text-align: center;
      border: 2px solid #333;
      padding: 5px;
      background: white;
    }
    
    .operator-photo {
      width: 80px;
      height: 100px;
      object-fit: cover;
      margin-bottom: 5px;
    }
    
    .photo-placeholder {
      width: 80px;
      height: 100px;
      border: 1px dashed #ccc;
      background: #f8f9fa;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #666;
      font-size: 8px;
      margin-bottom: 5px;
    }
    
    .photo-text {
      font-size: 7px;
      color: #333;
      line-height: 1.1;
    }
    
    .qr-container {
      display: inline-block;
      text-align: center;
      border: 2px solid #333;
      padding: 5px;
      background: white;
    }
    
    .qr-code { 
      width: 60px;
      height: 60px;
    }
    
    .qr-text {
      font-size: 6px;
      color: #333;
      margin-top: 2px;
      text-transform: uppercase;
    }
    
    /* Section Titles */
    .section-title { 
      font-size: 12px; 
      font-weight: bold; 
      margin: 15px 0 10px 0; 
      color: #333; 
      text-transform: uppercase;
      text-align: center;
    }
    
    /* Data Section */
    .data-section {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      margin-bottom: 15px;
    }
    
    .data-column {
      background: #f8f9fa;
      padding: 10px;
      border: 1px solid #ddd;
    }
    
    .data-row {
      display: flex;
      margin-bottom: 5px;
      padding-bottom: 3px;
      border-bottom: 1px solid #eee;
    }
    
    .data-label {
      font-weight: bold;
      color: #333;
      min-width: 120px;
      flex-shrink: 0;
      font-size: 9px;
    }
    
    .data-value {
      color: #333;
      flex: 1;
      padding-left: 10px;
      font-size: 9px;
    }
    
    /* Tables */
    .table-section {
      margin-bottom: 15px;
    }
    
    .table-title {
      font-weight: bold;
      margin-bottom: 8px;
      font-size: 10px;
      color: #333;
      text-transform: uppercase;
      text-align: center;
    }
    
    .data-table { 
      width: 100%; 
      border-collapse: collapse; 
      margin-bottom: 15px; 
      font-size: 8px;
    }
    
    .data-table th, .data-table td { 
      border: 1px solid #333; 
      padding: 5px 8px; 
      text-align: left; 
      vertical-align: top;
    }
    
    .data-table th { 
      background: #f0f0f0; 
      color: #333;
      font-weight: bold; 
      text-align: center;
      text-transform: uppercase;
      font-size: 8px;
    }
    
    .data-table tr:nth-child(even) {
      background-color: #f8f9fa;
    }
    
    .test-table { 
      width: 100%; 
      border-collapse: collapse; 
      margin-bottom: 15px; 
      font-size: 8px;
    }
    
    .test-table th, .test-table td { 
      border: 1px solid #333; 
      padding: 4px 8px; 
      text-align: center; 
      vertical-align: middle;
    }
    
    .test-table th { 
      background: #f0f0f0; 
      color: #333;
      font-weight: bold; 
      text-transform: uppercase;
      font-size: 8px;
    }
    
    .test-table td:first-child {
      text-align: left;
      font-weight: bold;
      color: #333;
    }
    
    .test-table tr:nth-child(even) {
      background-color: #f8f9fa;
    }
    
    .checkmark {
      font-weight: bold;
      color: #333;
      font-size: 10px;
    }
    
    /* Certification Statement */
    .certification-section {
      margin-top: 20px;
      padding: 15px;
      background: #f8f9fa;
      border: 1px solid #333;
      text-align: center;
      position: relative;
    }
    
    .certification-statement { 
      font-size: 10px; 
      font-style: italic; 
      color: #333;
      font-weight: normal;
      line-height: 1.4;
      margin: 0;
    }
    
    /* Action Buttons */
    .action-buttons { 
      text-align: center; 
      margin-top: 20px; 
      padding-top: 15px;
      border-top: 1px solid #ddd;
    }
    
    .btn { 
      display: inline-block; 
      padding: 8px 16px; 
      margin: 0 6px; 
      text-decoration: none; 
      border-radius: 3px; 
      font-size: 11px; 
      cursor: pointer; 
      font-weight: bold;
      text-transform: uppercase;
      border: none;
    }
    
    .btn-edit { 
      background: #007bff; 
      color: white; 
    }
    
    .btn-edit:hover {
      background: #0056b3;
    }
    
    .btn-delete { 
      background: #dc3545; 
      color: white; 
    }
    
    .btn-delete:hover {
      background: #c82333;
    }
    
    .btn-back { 
      background: #6c757d; 
      color: white; 
    }
    
    .btn-back:hover {
      background: #545b62;
    }
    
    .hide-in-print { 
      display: block; 
    }
    
    /* Print Styles */
    @media print { 
      .hide-in-print { display: none; } 
      body { 
        background: white; 
        padding: 0;
        font-size: 9px;
      } 
      .container { 
        box-shadow: none; 
        padding: 15px; 
        border-radius: 0;
        max-width: none;
      } 
      .header-section { 
        margin-bottom: 15px;
        padding-bottom: 10px;
      }
      .section-title {
        margin: 12px 0 8px 0;
        font-size: 10px;
      }
      .data-section {
        gap: 15px;
        margin-bottom: 12px;
      }
      .data-column {
        padding: 8px;
      }
      .data-row {
        margin-bottom: 4px;
        padding-bottom: 2px;
      }
      .table-section {
        margin-bottom: 12px;
      }
      .data-table, .test-table {
        margin-bottom: 12px;
        font-size: 7px;
      }
      .data-table th, .data-table td, .test-table th, .test-table td {
        padding: 4px 6px;
      }
      .certification-section {
        margin-top: 15px;
        padding: 12px;
      }
      .certification-statement {
        font-size: 9px;
      }
    }
    
    /* Responsive Design */
    @media (max-width: 768px) {
      .header-section { flex-direction: column; }
      .data-section { grid-template-columns: 1fr; }
      .container { padding: 15px; }
      .profile-section {
        justify-content: center;
        margin-top: 15px;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- Document Title -->
    <h1 class="document-title">WELDING OPERATOR PERFORMANCE QUALIFICATION TEST RECORD (WOPQ)</h1>

    <!-- Header Section -->
    <div class="header-section">
      <!-- Logo Section -->
      <div class="logo-section">
        <img src="/images/smallLogo.png" alt="ATECO Logo" class="ateco-logo">
        <div class="company-info">
          <strong>ATECO</strong><br>
          Material Testing, NDT, Training & Inspection Services
        </div>
      </div>
      
      <!-- Profile and QR Section -->
      <div class="profile-section">
        <div class="profile-container">
          <% if (record.profilePic) { %>
            <img src="<%= record.profilePic %>" alt="Operator Photo" class="operator-photo">
          <% } else { %>
            <div class="photo-placeholder">No Photo</div>
          <% } %>
          <div class="photo-text">
            <strong>Operator Photo</strong><br>
            ID: <%= record.operatorId || 'N/A' %>
          </div>
        </div>
        
        <div class="qr-container">
          <% if (record.qrLink) { %>
            <img src="<%= record.qrLink %>" alt="QR Code" class="qr-code">
            <div class="qr-text">Scan to verify</div>
          <% } else { %>
            <div class="qr-code" style="background: #f8f9fa; border: 1px dashed #ccc; display: flex; align-items: center; justify-content: center; color: #666; font-size: 7px;">
              QR Code
            </div>
            <div class="qr-text">Scan to verify</div>
          <% } %>
        </div>
      </div>
    </div>

    <!-- Welding Operator Data & Test Description Section -->
    <div class="section-title">Welding Operator Data & Test Description</div>
    
    <div class="data-section">
      <div class="data-column">
        <div class="data-row">
          <div class="data-label">Operator Name:</div>
          <div class="data-value"><%= record.operatorName || 'N/A' %></div>
        </div>
        <div class="data-row">
          <div class="data-label">Operator ID/Symbol:</div>
          <div class="data-value"><%= record.operatorId || 'N/A' %></div>
        </div>
        <div class="data-row">
          <div class="data-label">WPS followed:</div>
          <div class="data-value"><%= record.wpsFollowed || 'N/A' %></div>
        </div>
        <div class="data-row">
          <div class="data-label">Joint/Weld Type:</div>
          <div class="data-value"><%= record.jointWeldType || 'N/A' %></div>
        </div>
        <div class="data-row">
          <div class="data-label">Base Metal Spec.:</div>
          <div class="data-value"><%= record.baseMetalSpec || 'N/A' %></div>
        </div>
        <div class="data-row">
          <div class="data-label">Test Coupon Size:</div>
          <div class="data-value"><%= record.testCouponSize || 'N/A' %></div>
        </div>
      </div>
      
      <div class="data-column">
        <div class="data-row">
          <div class="data-label">Certificate No.:</div>
          <div class="data-value"><%= record.certificateNo || 'N/A' %></div>
        </div>
        <div class="data-row">
          <div class="data-label">Iqama/Passport:</div>
          <div class="data-value"><%= record.iqamaPassport || 'N/A' %></div>
        </div>
        <div class="data-row">
          <div class="data-label">Date of Issue:</div>
          <div class="data-value"><%= record.dateOfIssue || 'N/A' %></div>
        </div>
        <div class="data-row">
          <div class="data-label">Date of Welding:</div>
          <div class="data-value"><%= record.dateOfWelding || 'N/A' %></div>
        </div>
        <div class="data-row">
          <div class="data-label">Base Metal P-No.:</div>
          <div class="data-value"><%= record.baseMetalPNo || 'N/A' %></div>
        </div>
        <div class="data-row">
          <div class="data-label">Filler (SFA) Spec.:</div>
          <div class="data-value"><%= record.fillerSfaSpec || 'N/A' %></div>
        </div>
        <div class="data-row">
          <div class="data-label">Filler Class.(AWS):</div>
          <div class="data-value"><%= record.fillerClassAws || 'N/A' %></div>
        </div>
        <div class="data-row">
          <div class="data-label">Position(s):</div>
          <div class="data-value"><%= record.positions || 'N/A' %></div>
        </div>
      </div>
    </div>

    <!-- Testing Variables and Qualification Limits Section -->
    <div class="section-title">Testing Variables and Qualification Limits</div>
    
    <!-- Automatic Welding Equipment -->
    <div class="table-section">
      <div class="table-title">Testing Variables and Qualification Limits When Using Automatic Welding Equipment</div>
      
      <table class="data-table">
        <thead>
          <tr>
            <th>Welding Variables</th>
            <th>Actual Values</th>
            <th>Range Qualified</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>Type of Welding (Automatic)</td>
            <td>N/A</td>
            <td>N/A</td>
          </tr>
          <tr>
            <td>Welding Process</td>
            <td>N/A</td>
            <td>N/A</td>
          </tr>
          <tr>
            <td>Filler Metal Used (Yes or No) (EBW or LBW)</td>
            <td>N/A</td>
            <td>N/A</td>
          </tr>
          <tr>
            <td>Type of Laser for LBW (CO2 to YAG, etc.)</td>
            <td>N/A</td>
            <td>N/A</td>
          </tr>
          <tr>
            <td>Continuous Drive or Inertia Welding (FW)</td>
            <td>N/A</td>
            <td>N/A</td>
          </tr>
          <tr>
            <td>Vacuum or Out of Vacuum (EBW)</td>
            <td>N/A</td>
            <td>N/A</td>
          </tr>
        </tbody>
      </table>
    </div>

    <!-- Machine Welding Equipment -->
    <div class="table-section">
      <div class="table-title">Testing Variables and Qualification Limits When Using Machine Welding Equipment</div>
      
      <table class="data-table">
        <thead>
          <tr>
            <th>Welding Variables</th>
            <th>Actual Values</th>
            <th>Range Qualified</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>Type of Welding (Machine)</td>
            <td><%= record.typeOfWeldingMachine || 'Machine Welding' %></td>
            <td>Machine Welding</td>
          </tr>
          <tr>
            <td>Welding Process</td>
            <td><%= record.weldingProcessMachine || 'GTAW-Pulse' %></td>
            <td>GTAW-Pulse</td>
          </tr>
          <tr>
            <td>Direct or Remote Visual Control</td>
            <td><%= record.directRemoteVisualControl || 'Direct' %></td>
            <td>Direct</td>
          </tr>
          <tr>
            <td>Automatic Arc Voltage Control (GTAW)</td>
            <td><%= record.automaticArcVoltageControl || 'With' %></td>
            <td>With</td>
          </tr>
          <tr>
            <td>Automatic Joint Tracking</td>
            <td><%= record.automaticJointTracking || 'None' %></td>
            <td>None</td>
          </tr>
          <tr>
            <td>Position(s)</td>
            <td><%= record.positionsMachine || '2G (Rotated)' %></td>
            <td>Flat & Horizontal (Rotated)</td>
          </tr>
          <tr>
            <td>Base Material Thickness</td>
            <td><%= record.baseMaterialThickness || '5.5mm' %></td>
            <td>5.5mm to Unlimited</td>
          </tr>
          <tr>
            <td>Consumable Insert (GTAW or PAW)</td>
            <td><%= record.consumableInsert || 'None' %></td>
            <td>None</td>
          </tr>
          <tr>
            <td>Backing (With or Without)</td>
            <td><%= record.backing || 'With' %></td>
            <td>With</td>
          </tr>
          <tr>
            <td>Single or Multiple Passes Per Side</td>
            <td><%= record.singleMultiplePasses || 'Multiple' %></td>
            <td>Single / Multiple Passes</td>
          </tr>
        </tbody>
      </table>
    </div>

    <!-- Type of Qualification Test -->
    <div class="section-title">Type of Qualification Test</div>
    
    <table class="test-table">
      <thead>
        <tr>
          <th>Type of Qualification Test</th>
          <th>Test Performed</th>
          <th>Results</th>
          <th>Report Number</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>Visual Examination</td>
          <td class="checkmark"><%= record.visualExamination && record.visualExamination.performed ? '✓' : '' %></td>
          <td><%= record.visualExamination && record.visualExamination.results || '' %></td>
          <td><%= record.visualExamination && record.visualExamination.reportNumber || '' %></td>
        </tr>
        <tr>
          <td>Liquid Penetrant Examination (PT)</td>
          <td class="checkmark"><%= record.liquidPenetrantExamination && record.liquidPenetrantExamination.performed ? '✓' : '' %></td>
          <td><%= record.liquidPenetrantExamination && record.liquidPenetrantExamination.results || '' %></td>
          <td><%= record.liquidPenetrantExamination && record.liquidPenetrantExamination.reportNumber || '' %></td>
        </tr>
        <tr>
          <td>Ultrasonic Testing (UT)</td>
          <td class="checkmark"><%= record.ultrasonicTesting && record.ultrasonicTesting.performed ? '✓' : '' %></td>
          <td><%= record.ultrasonicTesting && record.ultrasonicTesting.results || '' %></td>
          <td><%= record.ultrasonicTesting && record.ultrasonicTesting.reportNumber || '' %></td>
        </tr>
        <tr>
          <td>Bend Test</td>
          <td class="checkmark"><%= record.bendTest && record.bendTest.performed ? '✓' : '' %></td>
          <td><%= record.bendTest && record.bendTest.results || '' %></td>
          <td><%= record.bendTest && record.bendTest.reportNumber || '' %></td>
        </tr>
      </tbody>
    </table>

    <!-- Certification Statement -->
    <div class="certification-section">
      <p class="certification-statement">
        We certify that the statements in this record are correct and that the test coupons were prepared, welded and tested in accordance with the requirements of Section IX of the ASME BOILER AND PRESSURE VESSEL CODE – 2021.
      </p>
    </div>

    <!-- Action Buttons -->
    <div class="action-buttons hide-in-print">
      <form action="/operator/edit/<%= record.operatorNo %>" method="post" style="display: inline;">
        <button type="submit" class="btn btn-edit">Edit Certificate</button>
      </form>
      <a href="/operator/delete/<%= record.operatorNo %>" class="btn btn-delete" onclick="return confirm('Are you sure you want to delete this operator certificate?')">Delete</a>
      <a href="/operator/list" class="btn btn-back">Back to List</a>
      <button onclick="window.print()" class="btn btn-edit">Print Certificate</button>
    </div>
  </div>
</body>
</html>
