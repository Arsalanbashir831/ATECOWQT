<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Insert Operator PERFORMANCE QUALIFICATION TEST RECORD</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
      line-height: 1.4;
      background-color: #f4f4f4;
    }

    .form-container {
      background: white;
      padding: 30px;
      border-radius: 8px;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
      max-width: 1000px;
      margin: auto;
    }

    h1 {
      text-align: center;
      color: #333;
      text-transform: uppercase;
      margin-bottom: 20px;
      border-bottom: 2px solid #333;
      padding-bottom: 10px;
    }

    .section {
      margin-bottom: 25px;
      border: 1px solid #ddd;
      padding: 15px;
      border-radius: 5px;
    }

    .section-title {
      font-weight: bold;
      background: #eee;
      padding: 8px;
      margin: -15px -15px 15px -15px;
      border-bottom: 1px solid #ddd;
      text-transform: uppercase;
    }

    .form-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 15px;
    }

    .form-group {
      display: flex;
      flex-direction: column;
    }

    label {
      font-weight: bold;
      margin-bottom: 5px;
    }

    input[type="text"],
    input[type="date"],
    input[type="file"],
    select {
      padding: 8px;
      border: 1px solid #ccc;
      border-radius: 4px;
    }

    .test-table,
    .data-table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 10px;
    }

    .test-table th,
    .test-table td,
    .data-table th,
    .data-table td {
      border: 1px solid #ddd;
      padding: 8px;
      text-align: left;
    }

    .test-table th,
    .data-table th {
      background: #f9f9f9;
    }

    .submit-btn {
      background-color: #28a745;
      color: white;
      padding: 12px 25px;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      font-size: 16px;
      font-weight: bold;
      display: block;
      margin: 20px auto;
    }

    .submit-btn:hover {
      background-color: #218838;
    }

    .photo-preview {
      width: 150px;
      height: 150px;
      border: 2px dashed #ddd;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-top: 10px;
      overflow: hidden;
    }

    .photo-preview img {
      max-width: 100%;
      max-height: 100%;
      display: none;
    }

    @media print {
      .hide-in-print {
        display: none;
      }
    }
  </style>
</head>

<body>
  <div class="form-container">
    <h1>Operator PERFORMANCE QUALIFICATION TEST RECORD</h1>

    <form action="/operator/insert" method="POST" enctype="multipart/form-data">
      <!-- Operator Identification -->
      <div class="section">
        <div class="section-title">Operator Identification</div>
        <div class="form-grid">
          <div class="form-group">
            <label for="clientName">Client Name:</label>
            <input type="text" id="clientName" name="clientName" placeholder="Enter Client Name">
          </div>
          <div class="form-group">
            <label for="operatorName">Operator Name:</label>
            <input type="text" id="operatorName" name="operatorName" required>
          </div>
          <div class="form-group">
            <label for="operatorId">Clock No / Identification No:</label>
            <input type="text" id="operatorId" name="operatorId" placeholder="System Generated if empty">
          </div>
          <div class="form-group">
            <label for="iqamaPassport">Iqama / Passport No:</label>
            <input type="text" id="iqamaPassport" name="iqamaPassport">
          </div>
          <!-- <div class="form-group">
            <label for="certificateNo">Certificate No:</label>
            <input type="text" id="certificateNo" name="certificateNo" placeholder="Auto-generated" readonly 
              style="color: green; font-weight: bold;">
          </div> -->
          <div class="form-group">
            <label for="profile">Profile Photo (Required):</label>
            <input type="file" id="profile" name="profile" accept="image/*" required>
            <div class="photo-preview">
              <img id="photoPreview" alt="Photo Preview">
              <span id="previewPlaceholder">Preview</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Test coupon description -->
      <div class="section">
        <div class="section-title">Test Coupon Description</div>
        <div class="form-grid">
          <div class="form-group">
            <label for="wpsFollowed">WPS Followed:</label>
            <input type="text" id="wpsFollowed" name="wpsFollowed">
          </div>
          <div class="form-group">
            <label for="jointWeldType">Joint Weld Type:</label>
            <input type="text" id="jointWeldType" name="jointWeldType">
          </div>
          <div class="form-group">
            <label for="baseMetalSpec">Base Metal Specification:</label>
            <input type="text" id="baseMetalSpec" name="baseMetalSpec">
          </div>
          <div class="form-group">
            <label for="baseMetalPNo">Base Metal P-Number:</label>
            <input type="text" id="baseMetalPNo" name="baseMetalPNo">
          </div>
          <div class="form-group">
            <label for="testCouponSize">Test Coupon Size:</label>
            <input type="text" id="testCouponSize" name="testCouponSize">
          </div>
          <div class="form-group">
            <label for="fillerSfaSpec">Filler SFA Spec:</label>
            <input type="text" id="fillerSfaSpec" name="fillerSfaSpec">
          </div>
          <div class="form-group">
            <label for="fillerClassAws">Filler Class AWS:</label>
            <input type="text" id="fillerClassAws" name="fillerClassAws">
          </div>
          <div class="form-group">
            <label for="positions">Positions:</label>
            <input type="text" id="positions" name="positions">
          </div>
          <div class="form-group">
            <label for="dateOfWelding">Date of Welding:</label>
            <input type="date" id="dateOfWelding" name="dateOfWelding">
          </div>
          <div class="form-group">
            <label for="dateOfIssue">Date of Issue:</label>
            <input type="date" id="dateOfIssue" name="dateOfIssue">
          </div>
        </div>
      </div>

      <!-- Testing Variables and Qualification Limits When Using Automatic Welding Equipment -->
      <div class="section">
        <div style="font-weight: bold; margin-bottom: 10px;">Testing Variables and Qualification Limits When Using
          Automatic Welding Equipment</div>
        <table class="data-table">
          <thead>
            <tr>
              <th>Welding variables</th>
              <th>Actual Values</th>
              <th>Range Qualified</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>Type of Welding (Automatic)</td>
              <td><input type="text" name="typeOfWeldingAutomaticActual" placeholder="Enter Actual Value"></td>
              <td><input type="text" name="typeOfWeldingAutomaticRange" placeholder="Enter Range Qualified"></td>
            </tr>
            <tr>
              <td>Welding Process</td>
              <td><input type="text" name="weldingProcessAutomaticActual" placeholder="Enter Actual Value"></td>
              <td><input type="text" name="weldingProcessAutomaticRange" placeholder="Enter Range Qualified"></td>
            </tr>
            <tr>
              <td>Filler Metal Used (GTAW/PAW)</td>
              <td><input type="text" name="fillerMetalUsedActual" placeholder="Enter Actual Value"></td>
              <td><input type="text" name="fillerMetalUsedRange" placeholder="Enter Range Qualified"></td>
            </tr>
            <tr>
              <td>Type of laser (LBW)</td>
              <td><input type="text" name="typeOfLaserActual" placeholder="Enter Actual Value"></td>
              <td><input type="text" name="typeOfLaserRange" placeholder="Enter Range Qualified"></td>
            </tr>
            <tr>
              <td>Countinous Drive or Inertia Welding (FW)</td>
              <td><input type="text" name="countinousDriveActual" placeholder="Enter Actual Value"></td>
              <td><input type="text" name="countinousDriveRange" placeholder="Enter Range Qualified"></td>
            </tr>
            <tr>
              <td>Vacuum or Out of Vacuum (EBW)</td>
              <td><input type="text" name="vacuumOutOfVacuumActual" placeholder="Enter Actual Value"></td>
              <td><input type="text" name="vacuumOutOfVacuumRange" placeholder="Enter Range Qualified"></td>
            </tr>
          </tbody>
        </table>
      </div>

      <!-- Testing Variables and Qualification Limits When Using Manual Welding Equipment -->
      <div class="section">
        <div style="font-weight: bold; margin-bottom: 10px;">Testing Variables and Qualification Limits When Using
          Machine Welding Equipment</div>

        <table class="data-table" id="machineVariablesTable">
          <thead>
            <tr>
              <th>Welding Variables</th>
              <th>Actual Values</th>
              <th>Range Qualified</th>
              <th class="hide-in-print">Action</th>
            </tr>
          </thead>
          <tbody id="machineVariablesBody">
            <!-- Rows will be added here by JavaScript -->
          </tbody>
        </table>
        <div class="hide-in-print" style="margin-bottom: 20px;">
          <button type="button" onclick="addMachineRow()"
            style="background-color: #28a745; color: white; border: none; padding: 8px 15px; border-radius: 4px; cursor: pointer;">+
            Add Variable Row</button>
        </div>
      </div>

      <!-- Type of Qualification Test -->
      <div class="section">
        <div class="section-title">Type of Qualification Test</div>

        <table class="test-table">
          <thead>
            <tr>
              <th>Type of Qualification Test</th>
              <th>Test Performed</th>
              <th>Results</th>
              <th>Report Number</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>Visual Examination</td>
              <td><input type="checkbox" name="visualExamination[performed]" value="true"></td>
              <td><input type="text" name="visualExamination[results]" placeholder="Enter Results"></td>
              <td><input type="text" name="visualExamination[reportNumber]" placeholder="Enter Report Number"></td>
            </tr>
            <tr>
              <td>Liquid Penetrant Examination (PT)</td>
              <td><input type="checkbox" name="liquidPenetrantExamination[performed]" value="true"></td>
              <td><input type="text" name="liquidPenetrantExamination[results]" placeholder="Enter Results"></td>
              <td><input type="text" name="liquidPenetrantExamination[reportNumber]" placeholder="Enter Report Number">
              </td>
            </tr>
            <tr>
              <td>Ultrasonic Testing (UT)</td>
              <td><input type="checkbox" name="ultrasonicTesting[performed]" value="true"></td>
              <td><input type="text" name="ultrasonicTesting[results]" placeholder="Enter Results"></td>
              <td><input type="text" name="ultrasonicTesting[reportNumber]" placeholder="Enter Report Number"></td>
            </tr>
            <tr>
              <td>Bend Test</td>
              <td><input type="checkbox" name="bendTest[performed]" value="true"></td>
              <td><input type="text" name="bendTest[results]" placeholder="Enter Results"></td>
              <td><input type="text" name="bendTest[reportNumber]" placeholder="Enter Report Number"></td>
            </tr>
            <tr>
              <td>Radiographic Examination (RT)</td>
              <td><input type="checkbox" name="radiographicExamination[performed]" value="true"></td>
              <td><input type="text" name="radiographicExamination[results]" placeholder="Enter Results"></td>
              <td><input type="text" name="radiographicExamination[reportNumber]" placeholder="Enter Report Number">
              </td>
            </tr>
          </tbody>
        </table>
      </div>

      <div class="section">
        <div class="section-title">Certification & Signatures</div>
        <div class="form-grid">
          <div class="form-group">
            <label for="witnessedBy">Testing Witnessed / Welder Inspector:</label>
            <input type="text" id="witnessedBy" name="witnessedBy" placeholder="Enter Name">
          </div>
          <div class="form-group">
            <label for="supervisorName">Test Supervisor / Technical Manager:</label>
            <input type="text" id="supervisorName" name="supervisorName" placeholder="Enter Name">
          </div>
        </div>
        <div class="section-title">We, the undersigned, certify that the statements in this record are correct and that
          the test coupons were prepared, welded and tested in accordance with the requirements of:</div>
        <input type="text" name="lawName" value="" required style="width: 100%;">
      </div>

      <!-- Submit Button -->
      <button type="submit" class="submit-btn">Generate Operator Performance Certificate</button>
    </form>
  </div>

  <script>
    // Photo preview functionality
    document.getElementById('profile').addEventListener('change', function (e) {
      const file = e.target.files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = function (e) {
          const preview = document.getElementById('photoPreview');
          const placeholder = document.getElementById('previewPlaceholder');
          preview.src = e.target.result;
          preview.style.display = 'block';
          placeholder.style.display = 'none';
        };
        reader.readAsDataURL(file);
      }
    });

    // Dynamic Machine Variables Logic
    const machineVariablesBody = document.getElementById('machineVariablesBody');
    const defaultVariables = [
      "Type of Welding (Machine)",
      "Welding Process",
      "Direct or Remote Visual Control",
      "Automatic Arc Voltage Control (GTAW)",
      "Automatic Joint Tracking",
      "Position(s)",
      "Base Material Thickness",
      "Consumable Insert (GTAW or PAW)",
      "Backing (With or Without)",
      "Single or Multiple Passes Per Side"
    ];

    function addMachineRow(label = "", actual = "", range = "") {
      const rowCount = machineVariablesBody.rows.length;
      const row = document.createElement('tr');
      row.innerHTML = `
        <td><input type="text" name="machineVariables[${rowCount}][label]" value="${label.replace(/"/g, '&quot;')}" placeholder="Variable Name"></td>
        <td><input type="text" name="machineVariables[${rowCount}][actualValue]" value="${actual.replace(/"/g, '&quot;')}" placeholder="Enter Actual Value"></td>
        <td><input type="text" name="machineVariables[${rowCount}][rangeQualified]" value="${range.replace(/"/g, '&quot;')}" placeholder="Enter Range Qualified"></td>
        <td class="hide-in-print">
          <button type="button" onclick="removeRow(this)" style="background-color: #dc3545; color: white; border: none; padding: 5px 10px; border-radius: 4px; cursor: pointer;">Remove</button>
        </td>
      `;
      machineVariablesBody.appendChild(row);
      reindexRows();
    }

    function removeRow(btn) {
      const row = btn.closest('tr');
      row.remove();
      reindexRows();
    }

    function reindexRows() {
      const rows = machineVariablesBody.querySelectorAll('tr');
      rows.forEach((row, index) => {
        row.querySelectorAll('input').forEach(input => {
          input.name = input.name.replace(/\[\d+\]/, `[${index}]`);
        });
      });
    }

    // Initialize default variables
    defaultVariables.forEach(v => addMachineRow(v));
  </script>
</body>

</html>